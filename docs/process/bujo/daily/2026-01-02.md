# Daily Log â€” 2026-01-02

## What I touched
- Ran the full test suite to verify the game state.
- Walked through Spy Adventure (1980 mode) to verify the game flow.
- Walked through Spy Adventure (2025 mode) to verify AI-mode flow.
- Walked through Spy Adventure (2025 mode) using longer statements to verify translation handling.
- Walked through Island Adventure (2025 mode) with long statements to verify pickup/crafting/gated-move translations.
- Updated the translator prompt/tests to handle inventory/pickup/crafting phrasing.
- Re-ran Island Adventure (2025 mode) to verify long pick-up phrasing now maps to the item label.
- Added an 85%+ coverage expectation to housekeeping docs and captured current JaCoCo coverage.
- Added a JaCoCo line-coverage gate (85%) to the Maven build and ran verify.
- Moved the GDL demo fixture into test resources and updated CLI/runtime tests to use the new path.
- Updated storybook notes and the games index to reflect the test-only GDL demo location.
- Renamed cookbook YAMLs to the `gardened-<game>` pattern and updated docs/tests/examples.
- Fixed README paths for world/narrative layouts and corrected the Western poster heading.
- Split GameRuntime into runtime helpers (scene, inventory, conversation, emote+dice) and delegated behavior.
- Split GameIntegrityCheck into simulation/key-expression helpers with shared label utilities and updated tests.
- Split KeyExpressionEvaluatorTest into focused scanner/evaluator/attribute tests with shared helpers.
- Extracted SmartActorRuntime snapshot/command resolver helpers and integrity simulation action/state helpers.
- Extracted key-expression spec/AST/validator helpers from integrity checks.
- Split GameRuntime combat/use logic into RuntimeCombat/RuntimeItemUse and extracted SmartActorHistoryRecorder.
- Added win-requirement evaluation helper with focused tests.
- Extracted explore/open/put into RuntimeCommandActions and added combat edge-case tests.
- Split navigation + trigger handling into RuntimeNavigation/RuntimeTriggers with delegated move/turn/reset flow.
- Moved game catalog + footprint rules + crafting defaults into YAML with new loaders and CLI/runtime wiring.
- Replaced Java sample games with YAML loads in tests/utilities and removed the sample classes.
- Updated playbook harness + CLI crafting test to use the new catalog entry and YAML recipes.
- Redesigned `docs/index.md` navigation and grouped docs by workflow.
- Removed stale ADR references, fixed prompt path mentions, and corrected test-game doc paths.
- Updated docs checklists/logs and the games index to reflect current test fixtures.

## Notes / Risks
- GDL demo no longer ships in main resources; runtime docs or menus should not assume it exists.
- Cookbook filenames changed; any external scripts must use the new `gardened-<game>.yaml` names.
- GameRuntime now delegates behavior to helpers; watch for any state sync regressions.
- SmartActorRuntime keeps test-only wrappers for reflection-based coverage of command/trim helpers.
- Combat flow now delegates to RuntimeCombat; ensure encounter state stays in sync across resets.
- Command actions now delegate to RuntimeCommandActions; watch for open/explore regressions.
- Navigation/trigger flow now delegates to helpers; watch for gate messaging or turn-advance regressions.
- Game catalog and footprint rules now load from YAML; ensure index/resources ship with builds.
- Docs index now reflects ADR removal and current prompt locations.
- Translator prompt now maps "check everything I'm carrying" to `inventory`.
- Translator needed explicit handling for "pick up ... stow" and "could you craft ..." phrasing; prompt now addresses both.
- Long pick-up phrasing with trailing words ("here for me") now resolves to the exact item label.
- JaCoCo line coverage is below 85% (instruction 80.35%, line 78.30%, branch 59.83%, method 88.30%); `mvn -q verify` now fails the coverage gate.

## Tests / Evidence
- `mvn -q test` (post-coverage gate run)
- `mvn -q verify` (fails: JaCoCo line coverage below 85%)
- `mvn -q -Dtest=GameMenuStructuredLoadTest test` (verification run)
- `./adventure --mode=1980` (Spy Adventure walkabout: look, inventory, move north, quit)
- `./adventure --mode=2025` (Spy Adventure walkabout: look, inventory, move north, quit)
- `./adventure --mode=2025` (Spy Adventure walkabout: long statements for look, inventory, move, quit)
- `./adventure --mode=2025` (Island Adventure walkabout: long statements for look, take, craft, move, gated move, quit)
- `./adventure --mode=2025` (Island Adventure walkabout: long pick-up phrasing + item label resolution)
- `mvn -q -Dtest=TranslatorPromptGoldenTest,TranslatorPromptCoverageTest test`
- `python3` (summed `target/site/jacoco/jacoco.csv` to report coverage)
- `mvn -q -Dtest=RuntimeLoaderTest,GdlCliSmokeTest,GamePlanCliTest test`
- `mvn -q -Dtest=GameSaveYamlWriterTest,GameSaveAssemblerTest test`
- `mvn -q -Dtest=GameIntegrityCheckCoverageTest,GameIntegrityTest,GameRuntimeCoverageTest,InteractionStateTest,MentionResolutionTest test`
- `mvn -q -Dtest='KeyExpression*Test,SmartActorRuntimeTest,SmartActorCombatPlaybookIntegrationTest,GameIntegrityCheckCoverageTest,GameIntegrityTest' test`
- `mvn -q -Dtest=GameIntegrityCheckCoverageTest,GameIntegrityTest test`
- `mvn -q -Dtest=GameRuntimeCoverageTest,SmartActorRuntimeTest,GameIntegrityCheckCoverageTest,GameIntegrityTest,IntegrityWinRequirementEvaluatorTest test`
- `mvn -q -Dtest=GameRuntimeCoverageTest,GameCliCombatErrorTest,RuntimeCombatEdgeCaseTest,SmartActorRuntimeTest,GameIntegrityCheckCoverageTest,IntegrityWinRequirementEvaluatorTest test`
- `mvn -q -Dtest=GameRuntimeCoverageTest,GameCliCombatErrorTest,RuntimeCombatEdgeCaseTest,SmartActorRuntimeTest,GameIntegrityCheckCoverageTest,IntegrityWinRequirementEvaluatorTest test`
- `mvn -q -Dtest=GameMenuStructuredLoadTest,GameCliHelperTest,GameCliWalkaboutFlowTest,GameCliQuitFlowTest,CraftingTableFlowTest,LoopRuntimeTest,GameSaveAssemblerTest,IslandAdventureIntegrationTest,ClueMansionIntegrationTest,GardenerClueMansionProofTest test`
- `mvn -q test`
- `printf "q\n" | ./adventure --mode=1980`
- Not run (docs cleanup).

## Next
- [ ] Validate narration continuity once RECENT_ACTIONS has real player data.
- [ ] Add/update narration service tests for direction-specific grounding edge cases.
- [ ] Verify fallback narration reads as a rewrite (not raw snapshot) on grounding failure.
- [ ] Review grounding tolerance with real LLM outputs and tune thresholds if needed.
