# Daily Log - 2025-12-21

## What I touched
- Wired .gdl loading into GameCli and GameBuilderCli with explicit extension/flag handling and diagnostics.
- Updated classpath backstory resolution to handle non-YAML game files.
- Documented the GDL rule that expressions must be quoted strings; refreshed the gap note.
- Added .gdl support to GardenerCli, GameStructExporter, WorldFingerprintDump, and WorldIdDump.
- Added a small GDL demo game and backstory, and exposed it in the GameCli menu.
- Printed backstory content at game start and adjusted the GDL demo start/key label.
- Added a CLI smoke test for GDL input via GameBuilderCli.
- Implemented structured PIL parsing with target/preposition/object fields and parse diagnostics.
- Added OPEN/USE/PUT/INSPECT verbs to the CLI with help text updates and minimal behavior.
- Added CommandScanner token coverage tests for prepositions and MOVE normalization.
- Normalized GO to MOVE at the scanner level and updated help text/tests to treat MOVE as canonical.
- Added a verb alias registry for documentation and reverse lookup tooling.
- Updated AI prompt files to prefer MOVE as the canonical movement verb.
- Wired verb alias registry into CLI help output and added alias registry tests.
- Converted the GDL demo game into storybook YAML and added storybook scaffolding files.
- Documented the storybook location in the docs index.
- Added a StorybookValidateCli to load GameSave YAML and run GameSaveAssembler validation.
- Added StorybookValidateCli smoke test and documentation under docs/howto/cli.
- Audited embedded content in core code (world defs, generator templates, mini demos) for relocation to YAML or test-only fixtures.
- Moved DescriptionTemplates and ZoneGraphBuilder hooks into `src/main/resources/storybook/shared` YAML configs with a shared loader.
- Removed heuristic fixture description expansion and replaced defaults with a no-op expander.
- Reorganized world package into model/build/io/gardener/samples subpackages and updated imports/usages.
- Removed unused private CLI/scanner helpers and aligned Thing.isOpen/isVisible with default key-expression resolvers; updated gardener proof test expander to avoid heuristics.
- Restored KeyExpressionScanner.readString for upcoming string parsing work.
- Ran repo-wide deep clean: added housekeeping docs/process/logs, updated README/docs for new package layout, cleared stale TODOs, and documented reserved scanner helper.
- Moved the zone input sample into src/test/resources/zone-demo and updated CLI/docs references.
- Moved Island Adventure backstory from docs into `src/main/resources/storybook/island` and added narrative-only storybook placeholders.
- Added Key Expression syntax doc under docs/reference/design and updated references.
- Moved design docs into docs/reference/design, moved the walkthrough into docs/howto/guides, and kept docs root limited to README/journal.
- Renamed prompt templates in `src/main/resources/agents` from .txt to .md and updated gardener expander path.
- Renamed docs/reference/architecture to docs/reference/design, added docs/index.md for the index, and simplified docs/readme.md.
- Removed docs/archive (legacy docs) and updated index/README references.
- Rewrote README with a full developer quick start, authoring guide, and runtime overview.

## Notes / Risks
- CLI behavior now requires a .gdl extension or --gdl flag for GDL inputs; YAML routing is unchanged.
- GDL demo is intentionally minimal and intended for manual playtest only.
- PUT with prepositions remains unimplemented; the CLI returns a clear message when attempted.
- Storybook YAML conversion passes GameSaveAssembler validation.
- Audit start: DescriptionTemplates embeds region/role hooks and fallback text; ZoneGraphBuilder embeds LANDMARK_HOOKS and CONNECTOR_NAMES. Additional candidates include IslandAdventure/ClueMansion game content, GameCli menu/minis, TwoPlotWorldFactory, CraftingTable fallback recipes, and heuristic fixture text.
- Storybook shared configs are now required for zone generation and description hooks; missing files will throw at load time.
- Gardener and AI fixture expanders no longer apply heuristic fallback text; default is no-op unless an expander is injected.
- World package reorg validated via full test run.
- Thing.isOpen/isVisible now use default resolvers when no explicit resolver is provided (matches tests/expected behavior).
- KeyExpressionScanner.readString remains unused but reserved for upcoming string literal handling.
- Storybook/island is narrative-only (no game.yaml in `src/main/resources/storybook` yet); runtime YAML remains under src/main/resources/games/island.
- Prompt templates now use .md extensions; ensure any external tooling references the renamed files.
- Docs/design rename and docs/index.md may require updating external links that referenced docs/reference/architecture or docs/readme.md.
- Removing docs/archive removes legacy links in historical notes; confirm no external pointers depend on it.
- README overhaul may supersede older dev docs; keep docs/index.md aligned with any future changes.

## Tests / Evidence
- `mvn -q -Dtest=GdlCompilerTest test`
- Manual playtest: `printf '5\nlook\ngo north\nlook\ngo south\nlook\ntake key\ninventory\nquit\n' | mvn -q -Dexec.mainClass=com.demo.adventure.engine.cli.GameCli -Dexec.args="--mode=1980" exec:java`
- `mvn -q -Dtest=GdlCliSmokeTest test`
- `mvn -q -Dtest=CommandCompilerTest,CommandScannerTest test`
- Manual playtest (PIL verbs): `printf '5\ninspect "entry table"\nopen "entry table"\ntake key\ninventory\nuse key on door\nput key in table\nput key\ninspect key\nopen "north"\ngo north\nquit\n' | mvn -q -Dexec.mainClass=com.demo.adventure.engine.cli.GameCli -Dexec.args="--mode=1980" exec:java`
- `mvn -q -Dtest=CommandCompilerTest,CommandScannerTest test` (MOVE normalization)
- `mvn -q -Dtest=TranslatorServiceTest test`
- `mvn -q -Dtest=VerbAliasesTest test`
- `mvn -q -Dexec.mainClass=com.demo.adventure.authoring.cli.WorldFingerprintDump -Dexec.args="src/main/resources/storybook/gdl-demo/game.yaml" exec:java`
- `jshell --class-path "target/classes:~/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar"` (load `src/main/resources/storybook/gdl-demo/game.yaml`, run `new GameSaveAssembler().apply(save)`)
- `java -cp "target/classes:$HOME/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar" com.demo.adventure.authoring.cli.StorybookValidateCli src/main/resources/storybook/gdl-demo/game.yaml`
- Not run (StorybookValidateCliSmokeTest).
- Not run (ZoneGraphBuilderTest / Storybook shared config changes).
- Not run (Gardener/GardenerDump changes).
- `mvn -q clean test`
- `mvn -q test`
- Not run (docs/storybook refactor).
- Not run (docs architecture move / prompt rename).
- Not run (docs archive removal).
- Not run (README overhaul).

## Next
- Consider adding automated CLI smoke tests for .gdl entry points.
