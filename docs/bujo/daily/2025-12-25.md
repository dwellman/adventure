# Daily Log — 2025-12-25

## What I touched
- Updated Scratch to warn (in caps) about the Time Stone trap and clarified his warden role.
- Softened Scratch's description to avoid spoiling the Time Stone too early.
- Restored Time Stone tick-rate acceleration on take (only time change trigger for Island).
- Adjusted Island Adventure progression so the hatchet is revealed via the skeleton interaction and the Time Stone no longer accelerates loop time.
- Fixed Spy Adventure mechanics by adding missing fixtures/items (postbox, latch, relief, shards, Jade Capsule) and ON_USE triggers for phrase/pass/stencil interactions.
- Logged full 1980 playthroughs for Island, Mansion, and Western adventures in the scoreboard.
- Logged a full 1980 Spy Adventure playthrough (manual run) in the scoreboard.
- Rebuilt the Spy Adventure playbook route using explicit gates and updated expectations for the win text.
- Regenerated `playbook.md` from the Spy playbook YAML.
- Added the Spy Adventure playbook integration test fixture to the test suite.
- Removed stray log artifacts created during script runs.
- Updated housekeeping logs/checklist and journal entries for the deep clean.
- Ran 1980 spot checks for Island/Mansion/Western/Spy adventures with basic commands.
- Ran 1980 motif-verb spot checks for Island/Mansion/Western/Spy adventures.
- Captured ASCII-normalized transcripts for the 1980 motif-verb spot checks.
- Reorganized Island/Mansion/Western/Spy resources into `world/`, `narrative/`, `motif/`, and `assets/` folders.
- Updated game.yaml includes plus RuntimeLoader/CraftingTable fallbacks for the new layout.
- Updated GameStructExporter/GamePlanCli outputs to emit `world/` + `narrative/` subfolders.
- Added per-game README.md files with non-player-facing design notes.
- Refreshed docs for the new paths (runbook/content/smart-actors/gameplan/index).
- Wired SmartActorRuntime with prompt/planner/registry + actor-scoped command execution and color passthroughs.
- Added smart-actor config defaults in `application.properties` and updated AI runbook/smart-actors docs.
- Added combat sim minigame + playbook and pinned dice rolls in playbook tests for deterministic combat output.
- Added a warded combat sim playbook to surface armor/magic weakness gaps.
- Allowed smart actors to take combat turns with restricted verbs and hesitation fallback.
- Added a smart-actor combat playbook/test harness to surface decision failures.
- Added playbook-driven smart actor decision scripting for deterministic combat tests.
- Added shared playbook test helper with smartActor decision/expectation parsing.
- Updated playbook integration tests to use the shared playbook loader.
- Added flee variant smart-actor combat playbook with scripted expectations.
- Advanced smart actor combat turns to increment turn index and skip cooldown/snapshot without stalling turns.
- Added smart-actor playbook variants for combat-sim and warded minigames.
- Added smart-actor specs for combat-sim and warded minigames.
- Fixed smart-actor combat playbook segment slicing to use character offsets.
- Synced smart-actor combat playbooks with real attack output by moving the player actor on plot change.
- Documented the game testing strategy and agent validation workflow.
- Added deterministic GameIntegrityCheck (static validation + bounded reachability) with report/config plumbing.
- Added GameIntegrityTest to run integrity checks for all structured games.
- Added a runtime output suppression toggle to support silent integrity simulations.
- Added BuuiConsole/ConsolePrinter output suppression to mute CLI prints in tests.
- Added a shared console capture extension and refit playbook integration tests to use it.
- Extended the console capture extension to include stderr and refit remaining CLI-output tests to use it.
- Updated ConsolePrinterTest to use the shared console capture extension (no direct System.out swapping).
- Pruned Island crafting recipes to remove unused items and align the craft list with actual inventory.
- Traced the Island raft chain and verified raft crafting works without dropping extra starter items after the backpack resize.
- Enlarged the Island Canvas Backpack to carry raft ingredients without dropping half the starter kit.
- Added a raft setup playbook for Island and wired it into the integration suite.
- Increased GameIntegrityConfig defaults to widen the reachability sweep.
- Added a test-only Island game YAML with a reduced clock gate for deterministic escape playbooks.
- Added an Island escape playbook and pointed Island playbooks at the test game.
- Added test-only Island runtime files (triggers/loop/crafting/backstory/aliases) for the playbook harness.
- Documented the Island test-game clock gate in the testing strategy.
- Updated the testing strategy doc with the integrity gate and bounded-search note.

## Notes / Risks
- Island loop timing no longer accelerates after the Time Stone trap; verify pacing remains tense but winnable.
- Hatchet now lives under the Treehouse Skeleton fixture, so players must use the skeleton to reveal it and free Scratch.
- Spy fixtures/items now include name-key owners; ensure future item ownership uses fixture names (keyFromName) for structured load.
- Island resets the day after specific actions (time stone + bamboo poles), wiping inventory and making raft progression unclear.
- Mansion run has no obvious accuse/solve loop; Case Board `use` has no effect and inventory capacity hides key clues.
- Western run times out at sundown; bridge cutters messaging is contradictory and telegraph console has no effect.
- 1980 Spy Adventure run did not reach a win; multiple described fixtures were not interactable and the Jade Capsule could not be obtained.
- Spy Adventure playbook steps depend on explicit gate wiring; map edits may require path updates.
- Win expectations key off the trigger text; changes to the win message will require playbook updates.
- GameStructExporter now emits `world/` + `narrative/` subfolders; any downstream scripts expecting flat files need updates.
- Smart actor combat now advances with hesitation on invalid outputs; decision quality still depends on policy and LLM output.
- Playbook tests now force max dice rolls, which may hide RNG edge cases.
- Warded combat sim is intentionally impossible to win by damage until weakness mechanics exist.
- Smart actor combat turns now increment an internal turn index; cooldown behavior in combat should be rechecked if tuning is needed.
- Smart-actor playbook variants currently script LOOK decisions, so combat logs show hesitation instead of attacks.
- Smart-actor combat output now depends on player actor ownership updating on move; verify in other movement flows if needed.
- Game integrity reachability is bounded by config; deep win checks require higher limits.
- Integrity now warns on missing crafting ingredients referenced only in recipes; strict enforcement may be tightened later.
- Integrity checks derive USE actions from ON_USE triggers plus cell-based items; if triggers omit targets, reachability may be under-sampled.
- BuuiConsole output suppression is global; tests should reset the mute flag to avoid leaking state.
- Console capture now runs per playbook test; reset the buffer after GameCli construction to avoid extra lines.
- Console capture now redirects stderr too; tests should assert on `console.error()` and reset buffers between runs.
- Scratch's description is now less explicit; ensure later beats still communicate his role when appropriate.
- Time Stone now accelerates time again; confirm pacing feels tense but fair after the reset.
- Island integrity reachability still caps at 5,000 states by depth 3, so Raft reachability remains a warning until bounds or search strategy are adjusted.
- Backpack capacity now allows Raft ingredients to fit; confirm this doesn’t trivialize other inventory gating.
- Island win reachability is still a warning in integrity (search-bound), but the test-only win playbook now validates escape text deterministically.

## Tests / Evidence
- `mvn -q -Dtest=GameMenuStructuredLoadTest,IslandAdventurePlaybookIntegrationTest test`
- `mvn -q -Dtest=GameMenuStructuredLoadTest,SpyAdventurePlaybookIntegrationTest test`
- Manual 1980 Island/Mansion/Western runs captured via `screen` hardcopy (local `/tmp/island1980.log`, `/tmp/mansion1980.log`, `/tmp/western1980.log`).
- Manual 1980 Spy Adventure run captured via `screen` hardcopy (local `/tmp/spy1980.log`).
- `mvn -q -Dtest=SpyAdventurePlaybookIntegrationTest test`
- `mvn -q test`
- `printf '1\nlook\ninventory\nsearch\neast\nlook\nwest\nquit\n' | ./adventure --mode=1980 --quiet`
- `printf '2\nlook\ninventory\nsearch\nwest\nlook\neast\nquit\n' | ./adventure --mode=1980 --quiet`
- `printf '3\nlook\ninventory\nsearch\neast\nlook\nwest\nquit\n' | ./adventure --mode=1980 --quiet`
- `printf '4\nlook\ninventory\nsearch\neast\nlook\nwest\nquit\n' | ./adventure --mode=1980 --quiet`
- `printf '1\nlook\nscavenge\nread rags\npaddle east\nlook\nrow west\nquit\n' | ./adventure --mode=1980 --quiet`
- `printf '2\nlook\nexamine case board\nprobe\nwest\nlook\neast\nquit\n' | ./adventure --mode=1980 --quiet`
- `printf '3\nlook\nscout\nride east\nlook\ntrot west\nquit\n' | ./adventure --mode=1980 --quiet`
- `printf '4\nlook\nsurveil\nsneak east\nscan\ntail west\nquit\n' | ./adventure --mode=1980 --quiet`
- `./adventure --mode=1980 --quiet` runs captured in `docs/playtests/1980-motif-spotcheck-2025-12-25.md`
- `mvn -q -Dtest=GameMenuStructuredLoadTest,GdlCliSmokeTest,SmartActorSpecLoaderTest test`
- `mvn -q -Dtest=MiniGamePlaybookIntegrationTest,SmartActorDecisionParserTest,SmartActorSpecLoaderTest,SmartActorTagLoaderTest test`
- `mvn -q -Dtest=MiniGamePlaybookIntegrationTest,SmartActorCombatPlaybookIntegrationTest test`
- `mvn -q -Dtest=IslandAdventurePlaybookIntegrationTest,MansionAdventurePlaybookIntegrationTest,WesternAdventurePlaybookIntegrationTest,SpyAdventurePlaybookIntegrationTest,MiniGamePlaybookIntegrationTest,SmartActorCombatPlaybookIntegrationTest test`
- `mvn -q -Dtest=NarratorFallbackTest,GameCliCombatErrorTest,GameCliExitFormattingTest,WorldAssemblerPrintsBomOnSuccessTest,WorldAssemblerPrintsReportOnFailureTest,GdlCliSmokeTest,StorybookValidateCliSmokeTest,KeyExpressionEvaluatorTest test`
- `mvn -q -Dtest=ConsolePrinterTest test`
- `mvn -q -Dtest=GameMenuStructuredLoadTest test`
- `printf '1\nNorth\nuse treehouse skeleton\ntake hatchet\nEast\ntake banana 1\ntake bamboo poles\nEast\ntake vine rope\nNorth\nEast\ndrop dead ipad\ntake parachute\nmake raft\nWest\nWest\nWest\nDown\nSouth\nQuit\n' | ./adventure --mode=1980 --quiet`
- `printf '1\nNorth\nuse treehouse skeleton\ntake hatchet\nEast\ndrop dead ipad\ntake bamboo poles\nQuit\n' | ./adventure --mode=1980 --quiet`
- `printf '1\nNorth\nuse treehouse skeleton\ntake hatchet\nEast\ndrop dead ipad\ntake bamboo poles\ntake banana 1\nEast\ntake vine rope\nNorth\nEast\ndrop notebook\ndrop pen\ndrop digital watch\ndrop hatchet\ntake parachute\nmake raft\nQuit\n' | ./adventure --mode=1980 --quiet`
- `printf '1\nNorth\nuse treehouse skeleton\ntake hatchet\nEast\ntake banana 1\ntake bamboo poles\nEast\ntake vine rope\nNorth\nEast\ntake parachute\nmake raft\nQuit\n' | ./adventure --mode=1980 --quiet`
- `jshell --class-path "$(cat target/classpath.txt):target/classes:target/test-classes"` (GameIntegrityCheck Island report)
- `mvn -q -Dtest=IslandAdventurePlaybookIntegrationTest,GameIntegrityTest test`
- `mvn -q test`
- `mvn -q -Dtest=GameIntegrityTest test`
- `mvn -q -Dtest=IslandAdventurePlaybookIntegrationTest test`
- Doc-only update (no tests run).
- `mvn -q -Dtest=MiniGamePlaybookIntegrationTest,SmartActorCombatPlaybookIntegrationTest test`
- `mvn -q -Dtest=SmartActorCombatPlaybookIntegrationTest,MiniGamePlaybookIntegrationTest test`
- `mvn -q -Dtest=IslandAdventurePlaybookIntegrationTest,MansionAdventurePlaybookIntegrationTest,WesternAdventurePlaybookIntegrationTest,SpyAdventurePlaybookIntegrationTest,MiniGamePlaybookIntegrationTest,SmartActorCombatPlaybookIntegrationTest test`
- `mvn -q -Dtest=MiniGamePlaybookIntegrationTest,SmartActorCombatPlaybookIntegrationTest test`

## Next
- Await next tasking.
